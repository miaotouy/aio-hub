# åª’ä½“ç”Ÿæˆä¸­å¿ƒ (Media Generation Hub) è®¾è®¡æ–¹æ¡ˆ

## 1. èƒŒæ™¯ä¸ç›®æ ‡

éšç€å¤šæ¨¡æ€ AI çš„çˆ†å‘ï¼Œç”¨æˆ·éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£æ¥ç”Ÿæˆé«˜è´¨é‡çš„å›¾ç‰‡ã€è§†é¢‘å’ŒéŸ³é¢‘ã€‚æœ¬é¡¹ç›®æ—¨åœ¨ç­–åˆ’å¹¶å®ç°ä¸€ä¸ª"ä¸€ç«™å¼åª’ä½“ç”Ÿæˆå·¥ä½œç«™"ï¼Œåˆ©ç”¨ç°æœ‰çš„ LLM åŸºç¡€è®¾æ–½ï¼Œæä¾›ä» Prompt ä¼˜åŒ–åˆ°åª’ä½“ç”Ÿæˆã€å†åˆ°èµ„äº§ç®¡ç†çš„å…¨æµç¨‹ä½“éªŒã€‚

## 2. æ ¸å¿ƒåŠŸèƒ½

### 2.1. å›¾ç‰‡ç”Ÿæˆ (Image Generation)

- **å¤šå¼•æ“æ”¯æŒ**: GPT Image 1.5, FLUX.2 Pro, Midjourney V7, Stable Diffusion XL Enhancedã€‚
- **å‚æ•°æ§åˆ¶**: åˆ†è¾¨ç‡ (1:1, 16:9, 9:16)ã€è´¨é‡çº§åˆ«ã€é£æ ¼é€‰æ‹©ã€‚
- **Prompt é­”æ³•**: é›†æˆ LLM åŠ©æ‰‹ï¼Œå°†ç®€å•çš„æè¿°æ‰©å†™ä¸ºé«˜è´¨é‡çš„ç»˜å›¾ Promptã€‚
- **å‚è€ƒå›¾ç”Ÿæˆ**: æ”¯æŒä¸Šä¼ å›¾ç‰‡ä½œä¸ºå‚è€ƒ (Image-to-Image)ï¼Œæ”¯æŒèº«ä»½ä¿æŒå’Œç›®æ ‡ç¼–è¾‘ã€‚

#### 2026 å¹´ä¸»æµå›¾ç‰‡ç”Ÿæˆæ¨¡å‹

| æ¨¡å‹åç§°                             | å¼€å‘è€…/æä¾›å•†       | å…³é”®ç‰¹æ€§ä¸æ›´æ–°                                                                         | API æ–¹æ³•ç¤ºä¾‹                                                                     | å¤‡æ³¨                                                                |
| ------------------------------------ | ------------------- | -------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| GPT Image 1.5                        | OpenAI              | æœ€å…ˆè¿›çš„å›¾åƒç”Ÿæˆï¼Œæ”¯æŒå¤šæ¨¡æ€æç¤ºã€æ›´ç²¾ç¡®ç¼–è¾‘å’Œæ–‡æœ¬æ¸²æŸ“ã€‚2025 å¹´åº•å‘å¸ƒï¼Œé€Ÿåº¦æå‡ 2-3xã€‚ | `openai.images.generate(model="gpt-image-1.5", prompt="æè¿°", size="1024x1024")` | å–ä»£ DALL-E 3ï¼ˆå·²äº 2026.5 å¼ƒç”¨ï¼‰ã€‚å…è´¹é¢åº¦æœ‰é™ï¼ŒPlus è®¢é˜… $20/æœˆã€‚ |
| FLUX.2 Pro                           | Black Forest Labs   | å¼€æºé«˜ä¿çœŸæ¨¡å‹ï¼Œæ”¯æŒä¸“ä¸šè´¨é‡å›¾åƒï¼Œ2025 å¹´ 11 æœˆå‘å¸ƒã€‚ELO åˆ†æ•° 1265ã€‚                   | POST `/generate` with `{ text, seed }`                                           | å¼ºè°ƒè‡ªå®šä¹‰æ§åˆ¶ï¼Œé€‚åˆç”Ÿäº§çº§åº”ç”¨ã€‚                                    |
| Midjourney V7                        | Midjourney          | è‰ºæœ¯é£æ ¼ä¼˜åŒ–ï¼Œ2025 å¹´ 4 æœˆå‘å¸ƒï¼Œé»˜è®¤æ¨¡å‹äº 6 æœˆå¯ç”¨ã€‚                                  | Discord/Web æ¥å£: `imagine prompt="æè¿°" --v 7`                                  | æœ€ä½³è‰ºæœ¯æ•ˆæœï¼Œé›†æˆ Discordã€‚éœ€ç¬¬ä¸‰æ–¹ API æ¡¥æ¥ã€‚                     |
| Nano Banana Pro (Gemini 3 Pro Image) | Google              | å¤šå›¾åƒè¾“å…¥å’Œç¼–è¾‘ï¼Œ2025 å¹´å‘å¸ƒã€‚æ”¯æŒèº«ä»½ä¿æŒå’Œç›®æ ‡ç¼–è¾‘ã€‚                                | `generateContent(prompt="æè¿°", model="nano-banana-pro")`                        | é›†æˆ Google ç”Ÿæ€ï¼Œé€Ÿåº¦å¿«ã€‚                                          |
| Stable Diffusion XL Enhanced         | Stability AI / Hive | å¢å¼ºç‰ˆï¼Œæ”¯æŒè‰ºæœ¯è§†è§‰å’Œåˆ›æ„é£æ ¼ã€‚2026 å¹´ä¼˜åŒ–ç‰ˆæœ¬ã€‚                                      | POST `/image-generation` with `{ model: "sdxl-enhanced", prompt }`               | å¼€æºï¼Œé€‚åˆæœ¬åœ°è¿è¡Œã€‚                                                |
| Qwen-Image-Edit-2509                 | Alibaba             | å¤šå›¾åƒç¼–è¾‘ï¼Œæ”¯æŒ ControlNet æ¡ä»¶ (æ·±åº¦ã€è¾¹ç¼˜)ã€‚2025 å¹´ 9 æœˆå‘å¸ƒã€‚                      | `pipeline("image-to-image", model="Qwen/Qwen-Image-Edit-2509")`                  | é«˜æ•ˆç¼–è¾‘ï¼Œé€Ÿåº¦æå‡ 12-25x çš„ Lightning å˜ä½“ã€‚                       |
| Imagen 4 Ultra                       | Google              | é«˜è´¨é‡æ–‡æœ¬åˆ°å›¾åƒï¼Œä¼ä¸šçº§ç»†èŠ‚ã€‚                                                         | `generateImage(model="imagen-4-ultra", prompt="æè¿°")`                           | ä¼ä¸šçº§ï¼Œæ³¨é‡ç»†èŠ‚ã€‚                                                  |
| Adobe Firefly 5                      | Adobe               | é›†æˆç…§ç‰‡ç¼–è¾‘ï¼Œ2025 å¹´å‘å¸ƒã€‚                                                            | POST `/generate` with `{ content, style }`                                       | å•†ä¸šå®‰å…¨ï¼Œç‰ˆæƒå‹å¥½ã€‚                                                |

> **æˆæœ¬å‚è€ƒ**: OpenAI GPT Image ~$0.04/å›¾åƒï¼›å¤šæ•° API éœ€ API Keyï¼Œå…³æ³¨é™é¢å’Œæˆæœ¬ã€‚

### 2.2. è§†é¢‘ç”Ÿæˆ (Video Generation)

- **æ–‡ç”Ÿè§†é¢‘ (Text-to-Video)**: åŸºäºæè¿°ç”ŸæˆçŸ­è§†é¢‘ï¼Œæ”¯æŒç‰©ç†è¿åŠ¨æ¨¡æ‹Ÿã€‚
- **å›¾ç”Ÿè§†é¢‘ (Image-to-Video)**: è®©é™æ€å›¾åŠ¨èµ·æ¥ï¼Œæ”¯æŒç”µå½±çº§æç»˜ã€‚
- **éŸ³é¢‘åŒæ­¥**: æ–°ä¸€ä»£æ¨¡å‹æ”¯æŒåŒæ­¥éŸ³é¢‘ç”Ÿæˆã€‚
- **æ¨¡å‹æ¥å…¥**: Sora 2 Pro, VEO 3.1 Fast, Kling 2.6, Runway Gen-4.5, Open-Sora 2.0ã€‚

#### 2026 å¹´ä¸»æµè§†é¢‘ç”Ÿæˆæ¨¡å‹

| æ¨¡å‹åç§°         | å¼€å‘è€…/æä¾›å•†      | å…³é”®ç‰¹æ€§ä¸æ›´æ–°                                    | API æ–¹æ³•ç¤ºä¾‹                                                               | å¤‡æ³¨                      |
| ---------------- | ------------------ | ------------------------------------------------- | -------------------------------------------------------------------------- | ------------------------- |
| Sora 2 Pro       | OpenAI             | å…‰å½±å‡†ç¡®ã€ç‰©ç†è¿åŠ¨ï¼ŒåŒæ­¥éŸ³é¢‘ç”Ÿæˆã€‚2025 å¹´åº•å‘å¸ƒã€‚ | `createVideo(prompt="æè¿°", duration=10s, resolution="1080p")`ï¼Œè½®è¯¢çŠ¶æ€ã€‚ | æœ€ä½³ä¿çœŸåº¦ï¼Œè®¢é˜… $20/æœˆã€‚ |
| VEO 3.1 Fast     | Google             | 8 ç§’ 720p/1080p å‰ªè¾‘ï¼Œå†…ç½®éŸ³é¢‘ã€‚2025 å¹´å‘å¸ƒã€‚     | `generateVideo(model="veo-3.1", prompt="æè¿°")`                            | é€Ÿåº¦å¿«ï¼Œ<3 ç§’ç”Ÿæˆã€‚       |
| Kling 2.6        | ByteDance/Kuaishou | é«˜è´¨é‡æ–‡æœ¬åˆ°è§†é¢‘ï¼Œå¤æ‚è¿åŠ¨ã€‚2026 å¹´ä¼˜åŒ–ã€‚         | POST `/text-to-video` with `{ prompt, max_duration: 30 }`                  | ä¸­å›½ä¸»å¯¼ï¼Œå›½é™…å¯ç”¨ã€‚      |
| Runway Gen-4.5   | Runway             | é«˜çº§æ§åˆ¶ï¼Œç¼–è¾‘æ”¯æŒã€‚2025 å¹´å‘å¸ƒã€‚                 | `execute(task="video-gen", params={ prompt: "æè¿°" })`                     | ä¸“ä¸šç¼–è¾‘ï¼Œ$15/æœˆã€‚        |
| WAN 2.6          | å¼€æºç¤¾åŒº           | å¤šè¯­è¨€ç¼–è¾‘ï¼ŒMoE æ¶æ„ã€‚2026 å¹´ 1 æœˆæ›´æ–°ã€‚          | é€šè¿‡ Hugging Face æˆ– SiliconFlow: `generate(video_prompt="æè¿°")`          | å¼€æºï¼Œé«˜æ•ˆã€‚              |
| Luma Ray 3       | Luma               | å›¾åƒåˆ°è§†é¢‘ï¼ŒåŠ¨æ€åŒ–é™æ€å›¾ã€‚                        | POST `/image-to-video` with `{ image_url, prompt }`                        | æ›´æ–°ç‰ˆæœ¬ï¼Œç»§æ‰¿æ–‡æ¡£è®¾è®¡ã€‚  |
| Open-Sora 2.0    | HPC-AI Tech        | ç»Ÿä¸€æ–‡æœ¬/å›¾åƒåˆ°è§†é¢‘ï¼Œ11B å‚æ•°ã€‚2026 å¹´ 3 æœˆå‘å¸ƒã€‚ | SiliconFlow/Replicate: `predict(model="open-sora-2.0", input="prompt")`    | å¼€æºï¼Œç”µå½±è´¨é‡ã€‚          |
| HunyuanVideo-I2V | Tencent            | å›¾åƒåˆ°è§†é¢‘ï¼Œç”µå½±çº§äººç±»æç»˜ã€‚                      | GitHub API: è‡ªå®šä¹‰èŠ‚ç‚¹é›†æˆã€‚                                               | å¼€æºï¼Œæ³¨é‡çœŸå®æ€§ã€‚        |

> **è½®è¯¢ç­–ç•¥**: å¼‚æ­¥ API é‡‡ç”¨æŒ‡æ•°é€€é¿ (Exponential Backoff) ç­–ç•¥ï¼Œé¿å…é«˜é¢‘è¯·æ±‚ã€‚å¼€æºæ¨¡å‹å¦‚ WAN å¯æœ¬åœ°è¿è¡Œã€‚

### 2.3. éŸ³é¢‘ç”Ÿæˆ (Audio & Music)

- **TTS (Text-to-Speech)**:
  - æ¨¡å‹ï¼šXTTS-v2, Chatterbox-Turbo, Fish Speech V1.5, ElevenLabs TTS, Google Cloud TTSã€‚
  - åŠŸèƒ½ï¼š6 ç§’æ ·æœ¬å£°éŸ³å…‹éš†ã€æƒ…æ„Ÿæ§åˆ¶ã€å¤šè¯­è¨€æ”¯æŒã€SSML æ ‡è®°è°ƒèŠ‚è¯­é€Ÿ/éŸ³è°ƒã€‚
- **éŸ³ä¹ç”Ÿæˆ (Music Gen)**:
  - æ¨¡å‹ï¼šSuno, Minimax Music-2, Stable Audio Open 1.0ã€‚
  - åŠŸèƒ½ï¼šæ­Œè¯åˆ›ä½œã€é£æ ¼å®šåˆ¶ã€éŸ³æ•ˆç”Ÿæˆã€‚

#### 2026 å¹´ä¸»æµéŸ³é¢‘ç”Ÿæˆæ¨¡å‹

| æ¨¡å‹åç§°              | å¼€å‘è€…/æä¾›å•† | å…³é”®ç‰¹æ€§ä¸æ›´æ–°                                        | API æ–¹æ³•ç¤ºä¾‹                                               | å¤‡æ³¨                                   |
| --------------------- | ------------- | ----------------------------------------------------- | ---------------------------------------------------------- | -------------------------------------- |
| XTTS-v2               | Coqui         | 6 ç§’æ ·æœ¬å…‹éš†ï¼Œå¤šè¯­è¨€ã€‚2025 å¹´æ›´æ–°ã€‚                   | `pipeline("text-to-speech", model="coqui/XTTS-v2")`        | æœ€å—æ¬¢è¿å¼€æº TTSã€‚                     |
| Chatterbox-Turbo      | Resemble AI   | 350M å‚æ•°ï¼Œæƒ…æ„Ÿå¤¸å¼ æ§åˆ¶ã€‚2025 å¹´å‘å¸ƒã€‚                | POST `/synthesize` with `{ text, emotion_level }`          | é«˜æ•ˆï¼Œä½ VRAMã€‚                        |
| Fish Speech V1.5      | Fish Audio    | DualAR æ¶æ„ï¼Œå¤šè¯­è¨€ (è‹±ä¸­æ—¥)ï¼ŒELO 1339ã€‚2026 å¹´ä¼˜åŒ–ã€‚ | SiliconFlow: `generate_speech(text="æ–‡æœ¬", language="zh")` | å¼€æºï¼ŒWER ä½è‡³ 3.5%ã€‚                  |
| ElevenLabs TTS        | ElevenLabs    | è‡ªç„¶è¡¨è¾¾ï¼Œå”‡åŒæ­¥ã€‚                                    | `text_to_speech(text="æ–‡æœ¬", voice_id="id")`               | $0.015/1000 å­—ç¬¦ã€‚æµè¡Œ TTSï¼Œé›†æˆè§†é¢‘ã€‚ |
| Google Cloud TTS      | Google        | 50+ è¯­è¨€ï¼Œ300+ å£°éŸ³ï¼ŒWaveNet è´¨é‡ã€‚                   | `synthesizeSpeech(text="æ–‡æœ¬", voice="en-US-Wavenet-D")`   | $16/1M å­—ç¬¦ã€‚ä¼ä¸šçº§ã€‚                  |
| Suno                  | Suno          | æ­Œè¯åˆ›ä½œï¼Œé£æ ¼å®šåˆ¶ã€‚                                  | `generate_music(lyrics="æ­Œè¯", style="rock")`              | æœ€ä½³éŸ³ä¹ç”Ÿæˆã€‚                         |
| Minimax Music-2       | Minimax       | é«˜ä¿çœŸéŸ³ä¹ï¼Œ2026 å¹´æ›´æ–°ã€‚                             | POST `/music-gen` with `{ prompt }`                        | æ–°å…´ï¼Œæ³¨é‡è´¨é‡ã€‚                       |
| Stable Audio Open 1.0 | Stability AI  | æ–‡æœ¬åˆ°éŸ³é¢‘ï¼ŒåŒ…å«éè¯­éŸ³éŸ³æ•ˆã€‚                          | `generate_audio(prompt="æè¿°")`                            | å¼€æºï¼Œåˆ›æ„éŸ³æ•ˆã€‚                       |

> **SSML æ”¯æŒ**: TTS API æ”¯æŒ SSML æ ‡è®°è°ƒèŠ‚è¯­é€Ÿ/éŸ³è°ƒï¼›éŸ³ä¹ API å¸¸éœ€æç¤ºå’Œç§å­å€¼ã€‚

### 2.4. ComfyUI æ¡¥æ¥ (ComfyUI Bridge)

é’ˆå¯¹é«˜çº§ç”¨æˆ·ï¼Œæä¾›"å·¥ä½œæµå³æ¨¡æ¿ (Workflow as Template)"çš„æ•´åˆæ¨¡å¼ï¼Œè§£å†³ ComfyUI ç•Œé¢å¤æ‚ã€ä¸ä¾¿æ—¥å¸¸ä½¿ç”¨çš„é—®é¢˜ã€‚

#### ComfyUI v0.8.1 (2026) æ–°ç‰¹æ€§

- **AMD ROCm 7.1.1 é›†æˆ**: æå‡ AMD GPU é€Ÿåº¦ 5.4xï¼Œæ‰©å¤§ç¡¬ä»¶æ”¯æŒèŒƒå›´ã€‚
- **æ–°æ¨¡å‹æ”¯æŒ**: LTXV 2ã€NVFP4ã€Wan2.1ã€HunyuanVideo-I2V ç­‰ã€‚
- **æ–°ç•Œé¢åŠŸèƒ½**: é€‰æ‹©å·¥å…·ç®±ã€å·¥ä½œæµæ¨¡æ¿åº“ã€å®æ—¶é¢„è§ˆ WebSocketã€‚
- **Manager UI æ›´æ–°**: é¢„å®‰è£…é¢„è§ˆã€æœ¬åœ°åŒ–æ”¯æŒ (å¤šè¯­è¨€)ã€‚

#### æ¡¥æ¥åŠŸèƒ½

- **å·¥ä½œæµå¯¼å…¥**: æ”¯æŒå¯¼å…¥ ComfyUI çš„ API æ ¼å¼ JSONã€‚
- **å‚æ•°æ˜ å°„ (Parameter Mapping)**: è‡ªåŠ¨è¯†åˆ«å·¥ä½œæµä¸­çš„å…³é”®è¾“å…¥èŠ‚ç‚¹ï¼ˆå¦‚ `KSampler` çš„ seed, `CLIPTextEncode` çš„ text, `LoadImage` çš„ imageï¼‰ï¼Œç”Ÿæˆç®€æ´çš„é…ç½®è¡¨å•ã€‚
- **è¿œç¨‹æ‰§è¡Œ**: é€šè¿‡ WebSocket è¿æ¥ `ws://localhost:8188/ws`ï¼Œå®æ—¶å›ä¼ ç”Ÿæˆé¢„è§ˆå›¾ï¼ˆPreview Imageï¼‰ã€‚

## 3. æ¶æ„è®¾è®¡ (åŸºäºè½¬å†™å·¥å…·æ¶æ„)

### 3.1. é€»è¾‘åˆ†å±‚ (Layered Architecture)

- **Registry (å¤–è§‚å±‚)**: `mediaGenerator.registry.ts` æä¾›å•ä¾‹æ¥å£ï¼Œä¾›å¤–éƒ¨è°ƒç”¨ã€‚
- **Store (çŠ¶æ€å±‚)**: `mediaGenStore.ts` ç»´æŠ¤å“åº”å¼ä»»åŠ¡é˜Ÿåˆ— `tasks: MediaTask[]` å’Œå…¨å±€é…ç½®ã€‚
- **Manager (è°ƒåº¦å±‚)**: `useMediaGenerationManager.ts` ç³»ç»Ÿçš„æŒ‡æŒ¥ä¸­å¿ƒã€‚
  - **å¹¶å‘æ§åˆ¶**: é™åˆ¶åŒæ—¶è¿›è¡Œçš„ç”Ÿæˆä»»åŠ¡æ•°ã€‚
  - **è½®è¯¢ç®¡ç†**: å¤„ç†å¼‚æ­¥ç”Ÿæˆ API çš„çŠ¶æ€æŸ¥è¯¢ï¼Œé‡‡ç”¨æŒ‡æ•°é€€é¿ç­–ç•¥ã€‚
  - **èµ„äº§å¯¼å…¥**: ä»»åŠ¡å®Œæˆåè‡ªåŠ¨è°ƒç”¨ `AssetManager`ã€‚
- **Engines (æ‰§è¡Œå±‚)**: é‡‡ç”¨ç­–ç•¥æ¨¡å¼ï¼Œé€šè¿‡ `IMediaEngine` æ¥å£å®ç°ä¸åŒæ¨¡æ€çš„ç”Ÿæˆé€»è¾‘ã€‚
  - `ImageEngine`: GPT Image 1.5 / FLUX.2 Pro / Midjourney V7 / SDXLã€‚
  - `VideoEngine`: Sora 2 Pro / VEO 3.1 / Kling 2.6 / Runway Gen-4.5ã€‚
  - `AudioEngine`: Fish Speech V1.5 / ElevenLabs TTS / Sunoã€‚
  - **ChatBridgeEngine (ç‰¹ç§å¼•æ“)**: ä¸“é—¨å¤„ç†ç¬¬ä¸‰æ–¹å°è£…æˆ–é€†å‘çš„å¯¹è¯å¼ç”Ÿæˆ APIã€‚
  - **ComfyEngine (é«˜çº§å¼•æ“)**: ä¸“é—¨å¯¹æ¥æœ¬åœ°æˆ–è¿œç¨‹ ComfyUI v0.8.1 å®ä¾‹ï¼Œæ”¯æŒå·¥ä½œæµæ¨¡æ¿åŒ–è¿è¡Œå’Œ AMD ROCm åŠ é€Ÿã€‚

### 3.2. åŸºç¡€è®¾æ–½é›†æˆ (Infrastructure Integration)

**èµ„äº§ç³»ç»Ÿ (Asset Management)**:

- **å¢é‡åˆ›å»º**: ä¸è½¬å†™å·¥å…·çš„"å­˜é‡å¤„ç†"æ¨¡å¼ä¸åŒï¼Œåª’ä½“ç”Ÿæˆä¸­å¿ƒæ¯æ¬¡æˆåŠŸç”Ÿæˆéƒ½ä¼šé€šè¿‡ `import_asset_from_bytes/path` åˆ›å»º**å…¨æ–°çš„èµ„äº§**ã€‚
- **ç”Ÿæˆæ ‡è®°**: å¯¼å…¥æ—¶ç»Ÿä¸€æ ‡è®°ä¸º `AssetOriginType.Generated`ï¼Œå¹¶è®°å½•å…·ä½“çš„ `source`ï¼ˆå¦‚ "gpt-image-1.5", "sora-2-pro"ï¼‰ã€‚
- **è¡ç”Ÿæ•°æ®æŒä¹…åŒ–**: èµ„äº§å¯¼å…¥åï¼Œç«‹å³è°ƒç”¨ `update_asset_derived_data` å°†ç”Ÿæˆæ—¶çš„æ ¸å¿ƒå‚æ•°ï¼ˆPrompt, Seed, Model Configï¼‰å­˜å…¥ `AssetMetadata.derived["generation"]`ã€‚è¿™ä½¿å¾—ç”¨æˆ·åœ¨èµ„äº§ç®¡ç†å™¨ä¸­æŸ¥çœ‹è¯¥æ–‡ä»¶æ—¶ï¼Œèƒ½ç›´æ¥æ‰¾å›å½“æ—¶çš„"ç»˜å›¾é…æ–¹"ã€‚
- **å»é‡è¡Œä¸º**: ç›´æ¥å¤ç”¨åç«¯èµ„äº§ç®¡ç†å™¨çš„å“ˆå¸Œå»é‡æœºåˆ¶ã€‚è‹¥ç”¨æˆ·å¤šæ¬¡å¯¼å…¥å®Œå…¨ç›¸åŒçš„ç”Ÿæˆæ–‡ä»¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆå¹¶æ¥æºï¼ˆOriginsï¼‰ï¼Œæ— éœ€å·¥å…·å±‚å¹²é¢„ã€‚

**è¿›åº¦å›ä¼ æœºåˆ¶**:

- å€Ÿé‰´ `video_processor.rs` çš„ `compress_video` æ¨¡å¼ï¼Œé€šè¿‡ Tauri Event ç³»ç»Ÿå‘å‰ç«¯å‘é€è¿›åº¦ã€‚
- **äº‹ä»¶åç§°**: `media-gen-progress`ï¼Œè½½è·åŒ…å« `taskId` å’Œ `progress` (0-100)ã€‚
- **è½®è¯¢ç®—æ³•**: é’ˆå¯¹å¼‚æ­¥ APIï¼ˆå¦‚ Sora, Kling, VEOï¼‰é‡‡ç”¨æŒ‡æ•°é€€é¿ (Exponential Backoff) ç­–ç•¥ï¼Œé¿å…é¢‘ç¹è¯·æ±‚ã€‚

**ComfyUI æ¡¥æ¥å®ç°**:

- **å‰ç«¯ç›´è¿**: å‰ç«¯é€šè¿‡æµè§ˆå™¨ WebSocket API ç›´æ¥è¿æ¥ `ws://localhost:8188/ws`ï¼Œå®æ—¶æ¥æ”¶é¢„è§ˆå›¾ã€‚
- **æ–‡ä»¶å¯¼å…¥**: ComfyUI ç”Ÿæˆçš„æ–‡ä»¶ä½äºæœ¬åœ°ç£ç›˜ï¼Œä»»åŠ¡å®Œæˆåè°ƒç”¨ `import_asset_from_path` å¯¼å…¥èµ„äº§ç³»ç»Ÿã€‚
- **å‚æ•°æ˜ å°„**: å¤ç”¨åç«¯ JSON è§£æç»éªŒï¼Œè§£æ ComfyUI çš„ `prompt` JSONï¼Œè‡ªåŠ¨ç”Ÿæˆé…ç½®è¡¨å•ã€‚
- **AMD åŠ é€Ÿ**: æ”¯æŒ ROCm 7.1.1 åç«¯æ£€æµ‹ï¼Œè‡ªåŠ¨é…ç½®ä¼˜åŒ–å‚æ•°ã€‚

### 3.3. æ ¸å¿ƒæ•°æ®æµ (Data Flow)

1.  **è¾“å…¥ä¸ä¼˜åŒ–**: ç”¨æˆ·è¾“å…¥ Promptï¼Œå¯é€‰è§¦å‘ `usePromptEnhancer` è°ƒç”¨ LLM è¿›è¡Œæ‰©å†™ã€‚
2.  **ä»»åŠ¡åˆ›å»º**: æ ¹æ®é€‰å®šçš„å¼•æ“å’Œå‚æ•°åˆ›å»º `MediaTask` å¹¶æ¨å…¥ `mediaGenStore`ã€‚
3.  **è°ƒåº¦æ‰§è¡Œ**: `Manager` ç›‘æµ‹åˆ°æ–°ä»»åŠ¡ï¼Œåˆ†é…ç»™å¯¹åº”çš„ `Engine` æ‰§è¡Œã€‚
4.  **å¼‚æ­¥ç”Ÿæˆä¸è¿›åº¦æ•è·**:
    - **æ ‡å‡† API**: å¼•æ“å‘èµ·å¼‚æ­¥è¯·æ±‚ï¼Œ`Manager` è´Ÿè´£å®šæ—¶è½®è¯¢çŠ¶æ€ï¼ˆæŒ‡æ•°é€€é¿ï¼‰ã€‚
    - **å¯¹è¯å¼/æµå¼ API (Chat Bridge)**: å¼•æ“å‘èµ·æµå¼å¯¹è¯è¯·æ±‚ï¼Œé€šè¿‡ `sse-parser` å®æ—¶è§£æå“åº”ã€‚åˆ©ç”¨æ­£åˆ™æ•è·å¯¹è¯ä¸­çš„è¿›åº¦ä¿¡æ¯ï¼ˆå¦‚ `(20%)`ï¼‰æˆ–çŠ¶æ€æè¿°ï¼ˆå¦‚ `Generating...`ï¼‰ï¼ŒåŒæ­¥æ›´æ–°è‡³ä»»åŠ¡çŠ¶æ€ã€‚
    - **ComfyUI æµå¼**: é€šè¿‡ WebSocket æ¥æ”¶å®æ—¶é¢„è§ˆå›¾ï¼Œæ›´æ–°ä»»åŠ¡é¢„è§ˆã€‚
5.  **ç»“æœè§£æä¸äº¤ä»˜**:
    - **è§£æ**: ä» API å“åº”æˆ–å¯¹è¯ç»“æŸåçš„æœ€ç»ˆæ¶ˆæ¯ä¸­æå–åª’ä½“ URLï¼ˆå¦‚ Markdown å›¾ç‰‡è¯­æ³•æˆ– JSON å—ï¼‰ã€‚
    - **ä¸‹è½½**: è°ƒç”¨åç«¯ä¸‹è½½å™¨ï¼ˆæˆ–å‰ç«¯ `fetch`ï¼‰è·å–åª’ä½“æ–‡ä»¶ã€‚
    - **èµ„äº§å¯¼å…¥**: è°ƒç”¨ `import_asset_from_bytes` æˆ– `import_asset_from_path`ï¼ŒæŒ‡å®š `origin: { type: "generated", source: "gpt-image-1.5", source_module: "media-generator" }`ã€‚
    - **è¡ç”Ÿæ•°æ®å­˜å‚¨**: è°ƒç”¨ `update_asset_derived_data`ï¼Œå°†ç”Ÿæˆå‚æ•°å­˜å…¥ `AssetMetadata.derived["generation"]`ã€‚
    - **çŠ¶æ€æ›´æ–°**: ä»»åŠ¡æ ‡è®°ä¸ºå®Œæˆï¼Œå…³è” `resultAssetId`ã€‚
6.  **å¤±è´¥å¤„ç†**: è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œæ”¯æŒæ‰‹åŠ¨é‡è¯•ï¼ˆä¿ç•™åŸå§‹å‚æ•°ï¼‰ã€‚

### 3.4. LLM API é€‚é…å™¨åŸºç¡€è®¾æ–½è°ƒæŸ¥ä¸æ‰©å±•æ–¹æ¡ˆ

#### ç°çŠ¶åˆ†æ

- **URL æ˜ å°„ (`openAiUrlHandler`)**: å·²ç»æ”¯æŒäº† `images/generations`, `audio/speech`, `videos` ç­‰ç«¯ç‚¹çš„æ˜ å°„é€»è¾‘ã€‚
- **UI é…ç½® (`CustomEndpointsEditor.vue`)**: å·²ç»ä¸ºç”¨æˆ·æä¾›äº†é…ç½®è¿™äº›é«˜çº§ç«¯ç‚¹çš„ç•Œé¢ã€‚
- **å¤šæ¨¡æ€æ”¯æŒ**: `callOpenAiCompatibleApi` å·²ç»åˆæ­¥æ”¯æŒäº† `input_audio` å’Œè§†é¢‘ä½œä¸º `image_url` çš„å°è¯•ã€‚
- **å±€é™æ€§**: ç°æœ‰çš„ `useLlmRequest` å¼ºåˆ¶è¦æ±‚ `messages` å‚æ•°ï¼Œä¸”ç¼ºä¹ä¸“é—¨å¤„ç†é Chat æ ¼å¼å“åº”ï¼ˆå¦‚è¿”å› URL æˆ–äºŒè¿›åˆ¶æ•°æ®ï¼‰çš„å‡½æ•°ã€‚

#### æ‰©å±•æ–¹æ¡ˆ

- **ç±»å‹å®šä¹‰æ‰©å±•**: åœ¨ `src/llm-apis/common.ts` ä¸­å¢åŠ  `ImageGenerationOptions`, `VideoGenerationOptions` ç­‰ç±»å‹ã€‚
- **é€‚é…å™¨å‡½æ•°**:
  - `callOpenAiImageApi`: å¤„ç† OpenAI æ ¼å¼çš„å›¾ç‰‡å“åº” (`{ data: [{ url: "..." }] }`)ã€‚
  - `callOpenAiVideoApi`: å¤„ç†è§†é¢‘ç”Ÿæˆ API çš„å¼‚æ­¥å“åº”å’ŒçŠ¶æ€æŸ¥è¯¢ã€‚
  - `callOpenAiAudioApi`: å¤„ç† TTS å“åº”ï¼ˆé€šå¸¸ä¸ºäºŒè¿›åˆ¶æµï¼‰ã€‚
- **`useLlmRequest` é‡æ„**: å¢åŠ  `sendImageRequest`, `sendVideoRequest`, `sendAudioRequest` æ–¹æ³•ï¼Œè§£è€¦ `messages` å¼ºåˆ¶ä¾èµ–ã€‚

### 3.5. æ•°æ®æ¨¡å‹ (Data Models)

```typescript
// src/tools/media-generator/types.ts
export interface MediaTask {
  id: string;
  type: AssetType; // å¤ç”¨ asset-management.ts
  status: "pending" | "processing" | "polling" | "completed" | "error" | "cancelled";

  // è¾“å…¥ä¸ä¼˜åŒ–
  input: {
    prompt: string;
    negativePrompt?: string;
    aspectRatio?: "1:1" | "16:9" | "9:16";
    style?: string;
    engineId: string;
    engineParams: Record<string, any>;
    // 2026 æ–°å¢ï¼šå¤šæ¨¡æ€è¾“å…¥
    referenceImages?: string[]; // å‚è€ƒå›¾ Asset IDs
    audioSync?: boolean; // è§†é¢‘æ˜¯å¦åŒæ­¥ç”ŸæˆéŸ³é¢‘
  };

  // çŠ¶æ€è·Ÿè¸ª
  progress: number; // 0-100
  statusText?: string; // "Queued", "Sampling", "Downloading"
  remoteTaskId?: string; // ç¬¬ä¸‰æ–¹ API çš„ä»»åŠ¡ ID
  previewImageUrl?: string; // å®æ—¶é¢„è§ˆå›¾ (ComfyUI)

  // ç»“æœå…³è”
  resultAssetId?: string; // å…³è”åˆ°å¯¼å…¥åçš„ Asset.id
  resultAudioAssetId?: string; // 2026 æ–°å¢ï¼šåŒæ­¥ç”Ÿæˆçš„éŸ³é¢‘èµ„äº§

  // æ—¶é—´çº¿
  createdAt: number;
  startedAt?: number;
  completedAt?: number;
}

export interface IMediaEngine {
  id: string;
  name: string;
  type: "image" | "video" | "audio";
  // 2026 æ–°å¢ï¼šèƒ½åŠ›å£°æ˜
  capabilities?: {
    supportsImageToImage?: boolean;
    supportsAudioSync?: boolean; // è§†é¢‘å¼•æ“æ˜¯å¦æ”¯æŒéŸ³é¢‘åŒæ­¥
    supportsIdentityPreservation?: boolean; // å›¾åƒå¼•æ“æ˜¯å¦æ”¯æŒèº«ä»½ä¿æŒ
  };
  execute(task: MediaTask): Promise<MediaTaskResult>;
  cancel?(taskId: string): Promise<void>;
}

export interface MediaTaskResult {
  success: boolean;
  assetId?: string;
  audioAssetId?: string; // 2026 æ–°å¢
  error?: string;
  downloadUrl?: string;
  localPath?: string;
}
```

## 4. UI ç•Œé¢ç­–åˆ’

### 4.1. æ•´ä½“å¸ƒå±€

é‡‡ç”¨ `el-tabs` åˆ‡æ¢ï¼š

- **ğŸ¨ ç”»å¸ƒ (Image)**: ç€‘å¸ƒæµå±•ç¤ºå†å²ç”Ÿæˆï¼Œå·¦ä¾§å‚æ•°åŒºï¼Œå³ä¾§å¤§å›¾é¢„è§ˆã€‚
- **ğŸ¬ å½±é™¢ (Video)**: è§†é¢‘ç”Ÿæˆä¸æ’­æ”¾åŒºï¼Œæ”¯æŒéŸ³é¢‘åŒæ­¥é¢„è§ˆã€‚
- **ğŸµ å½•éŸ³æ£š (Audio)**: TTS æ–‡æœ¬è¾“å…¥åŒºï¼Œé…éŸ³è§’è‰²å¡ç‰‡ï¼ŒéŸ³é¢‘åˆ—è¡¨ã€‚
- **ğŸ“‹ ä»»åŠ¡ä¸­å¿ƒ (Tasks)**: ç»Ÿä¸€æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨ç”Ÿæˆçš„åª’ä½“ä»»åŠ¡è¿›åº¦ã€‚

### 4.2. å…³é”®ç»„ä»¶

- `MediaTaskItem`: å±•ç¤ºç”Ÿæˆè¿›åº¦ã€é¢„è§ˆå›¾ã€é‡è¯•/å–æ¶ˆæŒ‰é’®ã€‚
- `PromptMagicBox`: å¸¦ AI æ‰©å†™æŒ‰é’®çš„æ–‡æœ¬æ¡†ã€‚
- `StylePresetSelector`: é¢„è®¾é£æ ¼ï¼ˆå†™å®ã€åŠ¨æ¼«ã€æ²¹ç”»ç­‰ï¼‰çš„è§†è§‰é€‰æ‹©å™¨ã€‚
- **ComfyWorkflowParser**: ä¸“é—¨ç”¨äºè§£æ ComfyUI JSON å¹¶æ¸²æŸ“åŠ¨æ€è¡¨å•çš„ç»„ä»¶ã€‚
- **ModelSelector**: æ¨¡å‹é€‰æ‹©å™¨ï¼ŒæŒ‰èƒ½åŠ›åˆ†ç»„æ˜¾ç¤ºï¼ˆæ”¯æŒ Image-to-Imageã€éŸ³é¢‘åŒæ­¥ç­‰ï¼‰ã€‚

## 5. æ‰©å±•æ€§è€ƒè™‘

- **æœ¬åœ°æ¨¡å‹æ”¯æŒ**: æ”¯æŒè°ƒç”¨æœ¬åœ°è¿è¡Œçš„ Stable Diffusion (WebUI/ComfyUI v0.8.1)ï¼Œåˆ©ç”¨ AMD ROCm 7.1.1 åŠ é€Ÿã€‚
- **å·¥ä½œæµè”åŠ¨**: ç”Ÿæˆå›¾ç‰‡ -> å‘é€è‡³å›¾ç”Ÿè§†é¢‘ -> ç”Ÿæˆè§†é¢‘ -> å‘é€è‡³ FFmpeg å‹ç¼©ã€‚
- **åç«¯ä¸‹è½½å™¨**: ä¸ºå¤„ç†å¤§æ–‡ä»¶ä¸‹è½½ï¼Œå¯åœ¨ Rust å±‚å¢åŠ æ”¯æŒè¿›åº¦å›ä¼ çš„ä¸‹è½½å‘½ä»¤ã€‚
- **å¼€æºæ¨¡å‹æœ¬åœ°è¿è¡Œ**: WAN 2.6ã€Open-Sora 2.0 ç­‰å¼€æºæ¨¡å‹å¯æœ¬åœ°éƒ¨ç½²ï¼Œå‡å°‘ API æˆæœ¬ã€‚

## 6. å¼€å‘è®¡åˆ’ (Milestones)

### Phase 1: åŸºç¡€æ¡†æ¶ä¸ GPT Image 1.5 é›†æˆ (é¢„è®¡ 3-5 å¤©)

- [ ] **ç±»å‹å®šä¹‰**: åˆ›å»º `src/tools/media-generator/types.ts`ã€‚
- [ ] **å­˜å‚¨å±‚**: åˆ›å»º `src/tools/media-generator/stores/mediaGenStore.ts`ã€‚
- [ ] **ç®¡ç†å™¨**: åˆ›å»º `src/tools/media-generator/composables/useMediaGenerationManager.ts`ï¼Œå®ç°ä»»åŠ¡é˜Ÿåˆ—å’Œå¹¶å‘æ§åˆ¶ã€‚
- [ ] **å¼•æ“åŸºç±»**: åˆ›å»º `src/tools/media-generator/engines/base.ts`ï¼Œå®šä¹‰ `IMediaEngine` æ¥å£ï¼ˆå«èƒ½åŠ›å£°æ˜ï¼‰ã€‚
- [ ] **GPT Image 1.5 å¼•æ“**: å®ç° `src/tools/media-generator/engines/gptImage.engine.ts`ï¼Œé›†æˆ OpenAI APIã€‚
- [ ] **èµ„äº§é›†æˆ**: åœ¨å¼•æ“ä¸­è°ƒç”¨ `useAssetManager` å¯¼å…¥ç”Ÿæˆç»“æœï¼Œå¹¶å­˜å‚¨è¡ç”Ÿæ•°æ®ã€‚
- [ ] **è¿›åº¦å›ä¼ **: å®ç° `media-gen-progress` äº‹ä»¶æœºåˆ¶ï¼ˆæŒ‡æ•°é€€é¿ï¼‰ã€‚

### Phase 2: å·¥ä½œå° UI ä¸ TTS é›†æˆ (é¢„è®¡ 2-3 å¤©)

- [ ] **å·¥ä½œå°ç»„ä»¶**: åˆ›å»º `src/tools/media-generator/components/MediaWorkbench.vue`ï¼Œå®ç°æ ‡ç­¾é¡µå¸ƒå±€ã€‚
- [ ] **ä»»åŠ¡åˆ—è¡¨**: åˆ›å»º `MediaTaskItem` ç»„ä»¶ï¼Œå±•ç¤ºè¿›åº¦å’Œé¢„è§ˆã€‚
- [ ] **å‚æ•°é¢æ¿**: å®ç°å›¾ç‰‡ç”Ÿæˆå‚æ•°æ§ä»¶ï¼ˆåˆ†è¾¨ç‡ã€é£æ ¼ç­‰ï¼‰ã€‚
- [ ] **TTS å¼•æ“**: å®ç° `src/tools/media-generator/engines/tts.engine.ts`ï¼Œæ”¯æŒ Fish Speech V1.5 å’Œ ElevenLabs TTSã€‚
- [ ] **éŸ³é¢‘æ’­æ”¾å™¨**: é›†æˆ `AudioPlayer` ç»„ä»¶ï¼Œæ”¯æŒç”Ÿæˆåå³æ—¶æ’­æ”¾ã€‚

### Phase 3: è§†é¢‘ç”Ÿæˆä¸ ComfyUI æ¡¥æ¥ (é¢„è®¡ 4-6 å¤©)

- [ ] **è§†é¢‘å¼•æ“**: å®ç° `src/tools/media-generator/engines/video.engine.ts`ï¼Œæ¥å…¥ Sora 2 Pro / Kling 2.6 APIã€‚
- [ ] **ComfyUI è§£æå™¨**: åˆ›å»º `ComfyWorkflowParser` ç»„ä»¶ï¼Œè§£æ JSON å·¥ä½œæµå¹¶ç”Ÿæˆè¡¨å•ã€‚
- [ ] **WebSocket è¿æ¥**: å®ç° ComfyUI v0.8.1 çš„å®æ—¶é¢„è§ˆè¿æ¥ã€‚
- [ ] **å‚æ•°æ˜ å°„**: å¼€å‘è‡ªåŠ¨æ˜ å°„ç®—æ³•ï¼Œå°†å·¥ä½œæµèŠ‚ç‚¹æ˜ å°„ä¸ºå‹å¥½é…ç½®é¡¹ã€‚
- [ ] **AMD æ£€æµ‹**: é›†æˆ ROCm 7.1.1 åç«¯æ£€æµ‹é€»è¾‘ã€‚

### Phase 4: é«˜çº§åŠŸèƒ½ä¸ä¼˜åŒ– (é¢„è®¡ 3-4 å¤©)

- [ ] **Prompt ä¼˜åŒ–**: é›†æˆ `usePromptEnhancer`ï¼Œæä¾›ä¸€é”®æ‰©å†™åŠŸèƒ½ã€‚
- [ ] **æ‰¹é‡ç”Ÿæˆ**: æ”¯æŒåŒä¸€ Prompt å¤šå°ºå¯¸/å¤šé£æ ¼æ‰¹é‡ç”Ÿæˆã€‚
- [ ] **å·¥ä½œæµè”åŠ¨**: å®ç°"å›¾ç‰‡ -> è§†é¢‘"ç­‰è·¨å·¥å…·æµæ°´çº¿ã€‚
- [ ] **æ€§èƒ½ä¼˜åŒ–**: æ‡’åŠ è½½å†å²ç”Ÿæˆï¼Œä¼˜åŒ–å¤§æ–‡ä»¶ä¸‹è½½ä½“éªŒã€‚
- [ ] **éŸ³é¢‘åŒæ­¥**: è§†é¢‘å¼•æ“æ”¯æŒåŒæ­¥éŸ³é¢‘ç”Ÿæˆï¼ˆSora 2 Pro, VEO 3.1ï¼‰ã€‚

---

## å‚è€ƒï¼š

src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ
src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ\è°·æ­Œé¦™è•‰.md
src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ\è°·æ­Œveo.md
src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ\oai-è§†é¢‘.md
src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ\oai-å›¾ç‰‡.md
src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ\oai-tts.md
src\llm-apis\å‚è€ƒdocs\åª’ä½“ç”Ÿæˆ\xai-å›¾ç‰‡.md

---

_æ–‡æ¡£ç‰ˆæœ¬: 3.1 | æ›´æ–°æ—¥æœŸ: 2026-01-20 | æ›´æ–°è€…: å’•å’• (Kilo) | æ•°æ®æ¥æº: Grok 2026.01 æ¨¡å‹è°ƒç ”_
